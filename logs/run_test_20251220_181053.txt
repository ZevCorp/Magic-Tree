--- Run Started at 20251220_181053 ---
/home/magicctree/Desktop/Magic-Tree/venv/lib/python3.13/site-packages/pygame/pkgdata.py:25: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import resource_stream, resource_exists
pygame 2.6.1 (SDL 2.28.4, Python 3.13.5)
Hello from the pygame community. https://www.pygame.org/contribute.html
2025-12-20 18:10:56,433 - INFO - ============================================================
2025-12-20 18:10:56,433 - INFO - MODO DE PRUEBA - Árbol Encantado
2025-12-20 18:10:56,433 - INFO - Experiencia completa SIN sensor de puerta
2025-12-20 18:10:56,433 - INFO - ============================================================
2025-12-20 18:10:56,433 - INFO - Running in MOCK MODE - GPIO disabled
2025-12-20 18:10:56,489 - INFO - Initializing persistent window: EnchantedTree
ALSA lib pcm_asym.c:105:(_snd_pcm_asym_open) capture slave is not defined
ALSA lib confmisc.c:1377:(snd_func_refer) Unable to find definition 'cards.0.pcm.front.0:CARD=0'
ALSA lib conf.c:5205:(_snd_config_evaluate) function snd_func_refer returned error: No such file or directory
ALSA lib conf.c:5728:(snd_config_expand) Evaluate error: No such file or directory
ALSA lib pcm.c:2722:(snd_pcm_open_noupdate) Unknown PCM front
ALSA lib pcm.c:2722:(snd_pcm_open_noupdate) Unknown PCM cards.pcm.rear
ALSA lib pcm.c:2722:(snd_pcm_open_noupdate) Unknown PCM cards.pcm.center_lfe
ALSA lib pcm.c:2722:(snd_pcm_open_noupdate) Unknown PCM cards.pcm.side
ALSA lib confmisc.c:1377:(snd_func_refer) Unable to find definition 'cards.0.pcm.surround51.0:CARD=0'
ALSA lib conf.c:5205:(_snd_config_evaluate) function snd_func_refer returned error: No such file or directory
ALSA lib conf.c:5728:(snd_config_expand) Evaluate error: No such file or directory
ALSA lib pcm.c:2722:(snd_pcm_open_noupdate) Unknown PCM surround21
ALSA lib confmisc.c:1377:(snd_func_refer) Unable to find definition 'cards.0.pcm.surround51.0:CARD=0'
ALSA lib conf.c:5205:(_snd_config_evaluate) function snd_func_refer returned error: No such file or directory
ALSA lib conf.c:5728:(snd_config_expand) Evaluate error: No such file or directory
ALSA lib pcm.c:2722:(snd_pcm_open_noupdate) Unknown PCM surround21
ALSA lib confmisc.c:1377:(snd_func_refer) Unable to find definition 'cards.0.pcm.surround40.0:CARD=0'
ALSA lib conf.c:5205:(_snd_config_evaluate) function snd_func_refer returned error: No such file or directory
ALSA lib conf.c:5728:(snd_config_expand) Evaluate error: No such file or directory
ALSA lib pcm.c:2722:(snd_pcm_open_noupdate) Unknown PCM surround40
ALSA lib confmisc.c:1377:(snd_func_refer) Unable to find definition 'cards.0.pcm.surround51.0:CARD=0'
ALSA lib conf.c:5205:(_snd_config_evaluate) function snd_func_refer returned error: No such file or directory
ALSA lib conf.c:5728:(snd_config_expand) Evaluate error: No such file or directory
ALSA lib pcm.c:2722:(snd_pcm_open_noupdate) Unknown PCM surround41
ALSA lib confmisc.c:1377:(snd_func_refer) Unable to find definition 'cards.0.pcm.surround51.0:CARD=0'
ALSA lib conf.c:5205:(_snd_config_evaluate) function snd_func_refer returned error: No such file or directory
ALSA lib conf.c:5728:(snd_config_expand) Evaluate error: No such file or directory
ALSA lib pcm.c:2722:(snd_pcm_open_noupdate) Unknown PCM surround50
ALSA lib confmisc.c:1377:(snd_func_refer) Unable to find definition 'cards.0.pcm.surround51.0:CARD=0'
ALSA lib conf.c:5205:(_snd_config_evaluate) function snd_func_refer returned error: No such file or directory
ALSA lib conf.c:5728:(snd_config_expand) Evaluate error: No such file or directory
ALSA lib pcm.c:2722:(snd_pcm_open_noupdate) Unknown PCM surround51
ALSA lib confmisc.c:1377:(snd_func_refer) Unable to find definition 'cards.0.pcm.surround71.0:CARD=0'
ALSA lib conf.c:5205:(_snd_config_evaluate) function snd_func_refer returned error: No such file or directory
ALSA lib conf.c:5728:(snd_config_expand) Evaluate error: No such file or directory
ALSA lib pcm.c:2722:(snd_pcm_open_noupdate) Unknown PCM surround71
ALSA lib confmisc.c:1377:(snd_func_refer) Unable to find definition 'cards.0.pcm.iec958.0:CARD=0,AES0=4,AES1=130,AES2=0,AES3=2'
ALSA lib conf.c:5205:(_snd_config_evaluate) function snd_func_refer returned error: No such file or directory
ALSA lib conf.c:5728:(snd_config_expand) Evaluate error: No such file or directory
ALSA lib pcm.c:2722:(snd_pcm_open_noupdate) Unknown PCM iec958
ALSA lib confmisc.c:1377:(snd_func_refer) Unable to find definition 'cards.0.pcm.iec958.0:CARD=0,AES0=4,AES1=130,AES2=0,AES3=2'
ALSA lib conf.c:5205:(_snd_config_evaluate) function snd_func_refer returned error: No such file or directory
ALSA lib conf.c:5728:(snd_config_expand) Evaluate error: No such file or directory
ALSA lib pcm.c:2722:(snd_pcm_open_noupdate) Unknown PCM spdif
ALSA lib confmisc.c:1377:(snd_func_refer) Unable to find definition 'cards.0.pcm.iec958.0:CARD=0,AES0=4,AES1=130,AES2=0,AES3=2'
ALSA lib conf.c:5205:(_snd_config_evaluate) function snd_func_refer returned error: No such file or directory
ALSA lib conf.c:5728:(snd_config_expand) Evaluate error: No such file or directory
ALSA lib pcm.c:2722:(snd_pcm_open_noupdate) Unknown PCM spdif
ALSA lib pcm.c:2722:(snd_pcm_open_noupdate) Unknown PCM cards.pcm.modem
ALSA lib pcm.c:2722:(snd_pcm_open_noupdate) Unknown PCM cards.pcm.modem
ALSA lib pcm.c:2722:(snd_pcm_open_noupdate) Unknown PCM cards.pcm.phoneline
ALSA lib pcm.c:2722:(snd_pcm_open_noupdate) Unknown PCM cards.pcm.phoneline
Cannot connect to server socket err = No such file or directory
Cannot connect to server request channel
jack server is not running or cannot be started
JackShmReadWritePtr::~JackShmReadWritePtr - Init not done for -1, skipping unlock
JackShmReadWritePtr::~JackShmReadWritePtr - Init not done for -1, skipping unlock
Cannot connect to server socket err = No such file or directory
Cannot connect to server request channel
jack server is not running or cannot be started
JackShmReadWritePtr::~JackShmReadWritePtr - Init not done for -1, skipping unlock
JackShmReadWritePtr::~JackShmReadWritePtr - Init not done for -1, skipping unlock
ALSA lib pcm_oss.c:404:(_snd_pcm_oss_open) Cannot open device /dev/dsp
ALSA lib pcm_oss.c:404:(_snd_pcm_oss_open) Cannot open device /dev/dsp
ALSA lib pcm_a52.c:1036:(_snd_pcm_a52_open) a52 is only for playback
ALSA lib confmisc.c:1377:(snd_func_refer) Unable to find definition 'cards.0.pcm.iec958.0:CARD=0,AES0=6,AES1=130,AES2=0,AES3=2'
ALSA lib conf.c:5205:(_snd_config_evaluate) function snd_func_refer returned error: No such file or directory
ALSA lib conf.c:5728:(snd_config_expand) Evaluate error: No such file or directory
ALSA lib pcm.c:2722:(snd_pcm_open_noupdate) Unknown PCM iec958:{AES0 0x6 AES1 0x82 AES2 0x0 AES3 0x2 CARD 0}
ALSA lib confmisc.c:160:(snd_config_get_card) Invalid field card
ALSA lib pcm_usb_stream.c:481:(_snd_pcm_usb_stream_open) Invalid card 'card'
ALSA lib confmisc.c:160:(snd_config_get_card) Invalid field card
ALSA lib pcm_usb_stream.c:481:(_snd_pcm_usb_stream_open) Invalid card 'card'
ALSA lib pcm_direct.c:1257:(snd1_pcm_direct_initialize_slave) requested or auto-format is not available
ALSA lib pcm_dmix.c:1012:(snd_pcm_dmix_open) unable to initialize slave
Cannot connect to server socket err = No such file or directory
Cannot connect to server request channel
jack server is not running or cannot be started
JackShmReadWritePtr::~JackShmReadWritePtr - Init not done for -1, skipping unlock
JackShmReadWritePtr::~JackShmReadWritePtr - Init not done for -1, skipping unlock
2025-12-20 18:10:56,947 - INFO - Loading Vosk model from /home/magicctree/Desktop/Magic-Tree/model/vosk-model-small-es-0.42...
LOG (VoskAPI:ReadDataFiles():model.cc:213) Decoding params beam=11 max-active=4000 lattice-beam=4
LOG (VoskAPI:ReadDataFiles():model.cc:216) Silence phones 1:2:3:4:5:6:7:8:9:10
LOG (VoskAPI:RemoveOrphanNodes():nnet-nnet.cc:948) Removed 0 orphan nodes.
LOG (VoskAPI:RemoveOrphanComponents():nnet-nnet.cc:847) Removing 0 orphan components.
LOG (VoskAPI:ReadDataFiles():model.cc:248) Loading i-vector extractor from /home/magicctree/Desktop/Magic-Tree/model/vosk-model-small-es-0.42/ivector/final.ie
LOG (VoskAPI:ComputeDerivedVars():ivector-extractor.cc:183) Computing derived variables for iVector extractor
LOG (VoskAPI:ComputeDerivedVars():ivector-extractor.cc:204) Done.
LOG (VoskAPI:ReadDataFiles():model.cc:282) Loading HCL and G from /home/magicctree/Desktop/Magic-Tree/model/vosk-model-small-es-0.42/graph/HCLr.fst /home/magicctree/Desktop/Magic-Tree/model/vosk-model-small-es-0.42/graph/Gr.fst
LOG (VoskAPI:ReadDataFiles():model.cc:308) Loading winfo /home/magicctree/Desktop/Magic-Tree/model/vosk-model-small-es-0.42/graph/phones/word_boundary.int
2025-12-20 18:10:57,425 - INFO - Vosk model loaded successfully.
2025-12-20 18:10:57,425 - INFO - Sistema listo.
2025-12-20 18:10:57,425 - INFO - 
En este modo:
2025-12-20 18:10:57,425 - INFO - ✓ La cámara se activará normalmente
2025-12-20 18:10:57,425 - INFO - ✓ El audio y detección de voz funcionan
2025-12-20 18:10:57,426 - INFO - ✓ Los videos se reproducen
2025-12-20 18:10:57,426 - INFO - ✗ El sensor de puerta está deshabilitado (presiona Enter)
2025-12-20 18:10:57,426 - INFO - 
2025-12-20 18:10:57,426 - INFO - Waiting for activation (Enter on Keypad/Window, 'Feliz Navidad', or Door Sensor)...
2025-12-20 18:10:57,426 - INFO - Entering Standby Mode (Video/Image Loop)...
2025-12-20 18:10:57,426 - INFO - Background music stopped.
2025-12-20 18:10:57,426 - INFO - Listening for keyword 'feliz navidad' (Local Vosk)...
2025-12-20 18:10:57,426 - INFO - Playing video: /home/magicctree/Desktop/Magic-Tree/assets/standby.mp4
[h264_v4l2m2m @ 0x7ffeec0338f0] Could not find a valid device
[h264_v4l2m2m @ 0x7ffeec0338f0] can't configure decoder
[00007ffeec031840] avcodec decoder error: cannot start codec (h264_v4l2m2m)
[00007ffe900f7630] wl_xdg_shell window: <<< WL XDG: 1280x720 fs 1 standalone 0
[00007ffe700061b0] wl_dmabuf vout display: <<< Open: I420 1280x738(1280x720 @ 0,0 0/0), cfg.display: 1280x720, source: 1280x738(1280x720 @ 0,0 1/1), scale=0/0
2025-12-20 18:11:05,830 - INFO - Video playback finished
2025-12-20 18:11:05,922 - INFO - Standby: Showing image, monitoring for 480s (Trigger/Face)...
2025-12-20 18:11:05,922 - INFO - Monitoring standby for 480 seconds (Face Detection Active)...
2025-12-20 18:11:28,395 - INFO - Keyword 'feliz navidad' detected!
2025-12-20 18:11:28,408 - INFO - Keyword listener stopped.
2025-12-20 18:11:28,707 - INFO - Standby interrupted by user action!
2025-12-20 18:11:28,707 - INFO - Iniciando experiencia...
2025-12-20 18:11:28,707 - INFO - Pre-initializing phone system components...
2025-12-20 18:11:28,730 - INFO - Loading Vosk model from /home/magicctree/Desktop/Magic-Tree/model/vosk-model-small-es-0.42...
LOG (VoskAPI:ReadDataFiles():model.cc:213) Decoding params beam=11 max-active=4000 lattice-beam=4
LOG (VoskAPI:ReadDataFiles():model.cc:216) Silence phones 1:2:3:4:5:6:7:8:9:10
LOG (VoskAPI:RemoveOrphanNodes():nnet-nnet.cc:948) Removed 0 orphan nodes.
LOG (VoskAPI:RemoveOrphanComponents():nnet-nnet.cc:847) Removing 0 orphan components.
LOG (VoskAPI:ReadDataFiles():model.cc:248) Loading i-vector extractor from /home/magicctree/Desktop/Magic-Tree/model/vosk-model-small-es-0.42/ivector/final.ie
LOG (VoskAPI:ComputeDerivedVars():ivector-extractor.cc:183) Computing derived variables for iVector extractor
LOG (VoskAPI:ComputeDerivedVars():ivector-extractor.cc:204) Done.
LOG (VoskAPI:ReadDataFiles():model.cc:282) Loading HCL and G from /home/magicctree/Desktop/Magic-Tree/model/vosk-model-small-es-0.42/graph/HCLr.fst /home/magicctree/Desktop/Magic-Tree/model/vosk-model-small-es-0.42/graph/Gr.fst
LOG (VoskAPI:ReadDataFiles():model.cc:308) Loading winfo /home/magicctree/Desktop/Magic-Tree/model/vosk-model-small-es-0.42/graph/phones/word_boundary.int
2025-12-20 18:11:29,450 - INFO - Vosk model loaded.
2025-12-20 18:11:29,450 - INFO - Phone system pre-initialized.
2025-12-20 18:11:29,450 - INFO - ==================================================
2025-12-20 18:11:29,450 - INFO - STEP 2: Playing intro video...
2025-12-20 18:11:29,450 - INFO - ==================================================
2025-12-20 18:11:29,450 - INFO - Playing video: /home/magicctree/Desktop/Magic-Tree/assets/intro.mp4
[00007ffe70104730] wl_xdg_shell window: <<< WL XDG: 1280x720 fs 1 standalone 0
[00007ffe60001360] wl_dmabuf vout display: <<< Open: I420 1280x738(1280x720 @ 0,0 0/0), cfg.display: 1280x720, source: 1280x738(1280x720 @ 0,0 1/1), scale=0/0
2025-12-20 18:11:44,741 - INFO - Video playback finished
2025-12-20 18:11:44,741 - INFO - Playing second intro video...
2025-12-20 18:11:44,741 - INFO - Video no encontrado (skipping): /home/magicctree/Desktop/Magic-Tree/assets/intro_2.mp4
2025-12-20 18:11:44,741 - INFO - ==================================================
2025-12-20 18:11:44,741 - INFO - STEP 3: Starting camera recording (20s)...
2025-12-20 18:11:44,741 - INFO - Recording will stop automatically after 20 seconds.
2025-12-20 18:11:44,741 - INFO - ==================================================
2025-12-20 18:11:44,742 - INFO - Starting recording to /home/magicctree/Desktop/Magic-Tree/recordings/user_video_1766272304.avi
2025-12-20 18:11:44,742 - INFO - Opening camera...
2025-12-20 18:11:44,742 - INFO - Attempting camera index 0...
2025-12-20 18:11:44,862 - INFO - Camera opened successfully on index 0!
2025-12-20 18:11:44,874 - INFO - Requested 1920x1080 @ 30fps MJPEG. Got: 1920.0x1080.0 @ 30.0fps
2025-12-20 18:11:44,931 - INFO - Recording Video: 1080x1920 @ 30.0fps
2025-12-20 18:11:44,931 - INFO - Recording started! 20 seconds countdown...
2025-12-20 18:12:05,018 - INFO - Timer finished!
2025-12-20 18:12:05,018 - INFO - Stopping recording... (186 frames captured)
2025-12-20 18:12:05,257 - INFO - Camera released, returned to black screen
2025-12-20 18:12:05,258 - INFO - Compressing video for WhatsApp...
2025-12-20 18:12:17,143 - INFO - Compression successful: /home/magicctree/Desktop/Magic-Tree/recordings/user_video_1766272304.mp4
2025-12-20 18:12:17,144 - INFO - ==================================================
2025-12-20 18:12:17,144 - INFO - STEP 4: Asking for phone number...
2025-12-20 18:12:17,144 - INFO - ==================================================
2025-12-20 18:12:17,144 - INFO - Playing video: /home/magicctree/Desktop/Magic-Tree/assets/ask_phone.mp4
[00007ffeb810a340] wl_xdg_shell window: <<< WL XDG: 1280x720 fs 1 standalone 0
[00007ffe68086d10] wl_dmabuf vout display: <<< Open: I420 1280x738(1280x720 @ 0,0 0/0), cfg.display: 1280x720, source: 1280x738(1280x720 @ 0,0 1/1), scale=0/0
2025-12-20 18:12:25,545 - INFO - Video playback finished
2025-12-20 18:12:26,045 - INFO - ==================================================
2025-12-20 18:12:26,046 - INFO - STEP 5: Starting continuous phone dictation...
2025-12-20 18:12:26,046 - INFO - ==================================================
2025-12-20 18:12:26,046 - INFO - ==================================================
2025-12-20 18:12:26,046 - INFO - STEP 5: Starting continuous phone dictation (Vosk)...
2025-12-20 18:12:26,046 - INFO - ==================================================
2025-12-20 18:12:26,046 - WARNING - Music file not found: /home/magicctree/Desktop/Magic-Tree/assets/background_music.mp3
2025-12-20 18:12:26,046 - INFO - Audio worker started (Vosk)
2025-12-20 18:12:26,046 - INFO - PhoneDisplay started on main thread
2025-12-20 18:12:26,046 - INFO - Loading Christmas background from /home/magicctree/Desktop/Magic-Tree/assets/christmas_bg.png
2025-12-20 18:12:26,071 - INFO - PhoneInputSystem: Listening...
2025-12-20 18:12:26,096 - INFO - Starting PhoneDisplay render loop
2025-12-20 18:12:30,594 - INFO - Heard: del numero de futbol
2025-12-20 18:12:32,279 - INFO - Heard: tres cincuenta
2025-12-20 18:12:35,871 - INFO - Heard: dos seis siete
2025-12-20 18:12:38,935 - INFO - Heard: ocho tres
2025-12-20 18:12:42,019 - INFO - Heard: sucede
2025-12-20 18:12:47,403 - INFO - Heard: sesenta precios
2025-12-20 18:12:47,403 - INFO - 10 digits reached: 3502678360. Verifying...
2025-12-20 18:12:54,046 - INFO - Heard: se te confirmo
2025-12-20 18:12:56,914 - INFO - Heard: confirmo
2025-12-20 18:13:02,075 - INFO - Heard: con cuales
2025-12-20 18:13:07,423 - INFO - Heard: caqueta confirmar
2025-12-20 18:13:07,424 - INFO - CONFIRMED!
2025-12-20 18:13:07,598 - INFO - Audio worker finished. Result: 3502678360
2025-12-20 18:13:07,634 - INFO - PhoneDisplay loop ended
2025-12-20 18:13:07,643 - INFO - Number captured and confirmed: 3502678360
2025-12-20 18:13:07,643 - INFO - Background music stopped.
2025-12-20 18:13:07,643 - INFO - Using compressed MP4 for sending.
2025-12-20 18:13:07,643 - INFO - Preparing to send welcome message to 3502678360 via Local Server...
2025-12-20 18:13:07,643 - INFO - Target Phone Number: 573502678360
2025-12-20 18:13:12,653 - ERROR - Error sending message request: HTTPConnectionPool(host='localhost', port=3000): Read timed out. (read timeout=5)
2025-12-20 18:13:12,653 - INFO - Metadata saved to /home/magicctree/Desktop/Magic-Tree/recordings/user_video_1766272304.json
2025-12-20 18:13:12,653 - INFO - STEP 8: Playing goodbye video...
2025-12-20 18:13:12,654 - INFO - Goodbye video not found, skipping.
2025-12-20 18:13:12,666 - INFO - 
============================================================
2025-12-20 18:13:12,666 - INFO - EXPERIENCIA COMPLETADA
2025-12-20 18:13:12,666 - INFO - ============================================================
2025-12-20 18:13:12,666 - INFO - Presiona Ctrl+C para salir o Enter para repetir (ESC para salir en ventana)...
2025-12-20 18:13:14,708 - INFO - Waiting for activation (Enter on Keypad/Window, 'Feliz Navidad', or Door Sensor)...
2025-12-20 18:13:14,708 - INFO - Entering Standby Mode (Video/Image Loop)...
2025-12-20 18:13:14,709 - INFO - Background music stopped.
2025-12-20 18:13:14,711 - INFO - Listening for keyword 'feliz navidad' (Local Vosk)...
2025-12-20 18:13:14,712 - INFO - Playing video: /home/magicctree/Desktop/Magic-Tree/assets/standby.mp4
[00007ffe5c15d4b0] wl_xdg_shell window: <<< WL XDG: 1280x720 fs 1 standalone 0
[00007ffe9c0093c0] wl_dmabuf vout display: <<< Open: I420 1280x738(1280x720 @ 0,0 0/0), cfg.display: 1280x720, source: 1280x738(1280x720 @ 0,0 1/1), scale=0/0
2025-12-20 18:13:23,059 - INFO - Video playback finished
2025-12-20 18:13:23,148 - INFO - Standby: Showing image, monitoring for 480s (Trigger/Face)...
2025-12-20 18:13:23,148 - INFO - Monitoring standby for 480 seconds (Face Detection Active)...
2025-12-20 18:21:23,513 - INFO - Playing video: /home/magicctree/Desktop/Magic-Tree/assets/standby.mp4
[00007ffe680bd400] wl_xdg_shell window: <<< WL XDG: 1280x720 fs 1 standalone 0
[00007ffeb00f3cf0] wl_dmabuf vout display: <<< Open: I420 1280x738(1280x720 @ 0,0 0/0), cfg.display: 1280x720, source: 1280x738(1280x720 @ 0,0 1/1), scale=0/0
2025-12-20 18:21:32,114 - INFO - Video playback finished
2025-12-20 18:21:32,210 - INFO - Standby: Showing image, monitoring for 480s (Trigger/Face)...
2025-12-20 18:21:32,210 - INFO - Monitoring standby for 480 seconds (Face Detection Active)...
2025-12-20 18:25:26,127 - INFO - Face detected! Triggering Standby Video.
2025-12-20 18:25:26,393 - INFO - Face detected in standby! Playing video...
2025-12-20 18:25:26,393 - INFO - Playing video: /home/magicctree/Desktop/Magic-Tree/assets/standby.mp4
[00007ffe58161ad0] wl_xdg_shell window: <<< WL XDG: 1280x720 fs 1 standalone 0
[00007ffe70000df0] wl_dmabuf vout display: <<< Open: I420 1280x738(1280x720 @ 0,0 0/0), cfg.display: 1280x720, source: 1280x738(1280x720 @ 0,0 1/1), scale=0/0
2025-12-20 18:25:34,910 - INFO - Video playback finished
2025-12-20 18:25:34,999 - INFO - Standby: Showing image, monitoring for 480s (Trigger/Face)...
2025-12-20 18:25:35,000 - INFO - Monitoring standby for 480 seconds (Face Detection Active)...
